<!DOCTYPE html>
<html lang="zh-cn">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.41" />
  <meta name="author" content="Peng Zhao">
  <meta name="description" content="Post-doc in Geoecology">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="http://www.pzhao.org/index.xml" type="application/rss+xml" title="Peng Zhao">
  <link rel="feed" href="http://www.pzhao.org/index.xml" type="application/rss+xml" title="Peng Zhao">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="http://www.pzhao.org/archives/14974/">

  

  <title>R 菜鸟生活篇 复活节到底是哪一天 | Peng Zhao</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">切换导航</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/zh/">Peng Zhao</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/zh/#about">
            
            <span>关于</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/tags/news">
            
            <span>新闻</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/tags/post">
            
            <span>日志</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/publication">
            
            <span>论文</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/talk">
            
            <span>报告</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/#projects">
            
            <span>项目</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/#teaching">
            
            <span>教学</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/#unclassified">
            
            <span>其他</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="https://cse.google.com/cse/publicurl?cx=006346710622437628329:nxozn9fijm0">
            
            <span>搜索</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/en">
            
            <span>EN</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

  <div class="article-container">
    <h1 itemprop="name">R 菜鸟生活篇 复活节到底是哪一天</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2013-04-04 08:13:23 &#43;0000 &#43;0000" itemprop="datePublished">
      Thu, Apr 4, 2013
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/zh/categories/%e6%9c%aa%e5%88%86%e7%b1%bb">未分类</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/zh/tags/r">R</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fwww.pzhao.org%2farchives%2f14974%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=R%20%e8%8f%9c%e9%b8%9f%e7%94%9f%e6%b4%bb%e7%af%87%20%e5%a4%8d%e6%b4%bb%e8%8a%82%e5%88%b0%e5%ba%95%e6%98%af%e5%93%aa%e4%b8%80%e5%a4%a9&amp;url=http%3a%2f%2fwww.pzhao.org%2farchives%2f14974%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fwww.pzhao.org%2farchives%2f14974%2f&amp;title=R%20%e8%8f%9c%e9%b8%9f%e7%94%9f%e6%b4%bb%e7%af%87%20%e5%a4%8d%e6%b4%bb%e8%8a%82%e5%88%b0%e5%ba%95%e6%98%af%e5%93%aa%e4%b8%80%e5%a4%a9"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=http%3a%2f%2fwww.pzhao.org%2farchives%2f14974%2f&amp;title=R%20%e8%8f%9c%e9%b8%9f%e7%94%9f%e6%b4%bb%e7%af%87%20%e5%a4%8d%e6%b4%bb%e8%8a%82%e5%88%b0%e5%ba%95%e6%98%af%e5%93%aa%e4%b8%80%e5%a4%a9"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=R%20%e8%8f%9c%e9%b8%9f%e7%94%9f%e6%b4%bb%e7%af%87%20%e5%a4%8d%e6%b4%bb%e8%8a%82%e5%88%b0%e5%ba%95%e6%98%af%e5%93%aa%e4%b8%80%e5%a4%a9&amp;body=http%3a%2f%2fwww.pzhao.org%2farchives%2f14974%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>地球上的人类爱过节，男人可以趁机放假，女人可以借机购物。人类最重要的节日，在东方当属春节、中国国庆节和劳动节，在西方当属圣诞节、元旦和复活节。前五个都好说，阳历或阴历上的日期是确定的，那么，聪明的你，我提个问题：最后那个，就是复活节，是在哪一天？</p>

<p>你回答说：</p>

<blockquote>
<p>复活节是每年春分月圆之后第一个星期日。</p>
</blockquote>

<p>OK。那么，再问：那它到到到到到底是哪一天……</p>

<p>三个关键词：春分，这是阳历；月圆，这是阴历；星期日，这是不阴不阳的历。敢问这是哪位高人定的，是在考验人类的计算水平吗？够狠。</p>

<p>一查才知道，的确是在考计算。英文的 computer 是“计算机”，compute 和 computation 分别是动词和名词的“计算”，他们均来自拉丁语的Computus，而这个词的本意就是“计算复活节的方法”！</p>

<p>我又问了：为啥是这样规定呢？</p>

<p>你说：</p>

<blockquote>
<p>春分，是因为此后北半球开始日长夜短，意味着光明；月圆，是因为夜晚也洒满光辉，也意味着光明；星期日，是因为这天大家都休息，不用倒休。</p>
</blockquote>

<p>我脑海中立刻浮现出明教、日月神教等字眼，嘴上只好说，好吧，算你有理。我算是勉强被说服了，但是听到你的下一句话，我崩溃了，你说：</p>

<blockquote>
<p>只不过啊，天主教和东正教的复活节是两种不同的计算方法……</p>
</blockquote>

<p>基督教有三大主要派别，其中天主教和基督新教（华语圈常简称基督教）属于西方罗马教会，使用公历；东正教属于东方教会，使用儒略历。</p>

<p>我不信教，这已经超出我大脑能理解的极限了。没啥说的，请 <strong>R</strong> 出马，自己写个自定义函数，看看这个 Computus 是怎么计算的吧。计算方法可以选择高斯还是米乌斯，日历可以选择公历还是儒略历。因此，整个函数的结构是两个大分支下各有两个小分支。</p>

<pre lang="rsplus">computus  &lt;- function(year = 2013, method = "Meeus", calendar = "Gregorian")
{
  Y &lt;- year
  # 高斯算法
  if (method == "Gauss") # 适用于 1583 - 2299 年
  {
# 公历（天主教）
    if (calendar == "Gregorian")
    {
      k &lt;- (Y - 1500) %/% 100 + 1
      M &lt;- c(22,22,23,23,24,24,24,25)[k]
      N &lt;- c(2,2,3,4,5,5,6,0)[k]
      
    } else if (calendar == "Julian")
# 儒略历（东正教）
    {
      M &lt;- 15; N &lt;- 6
    } else
    {
      print("sorry, the calendar does not exist. use method = 'Gregorian' or 'Julian'")
    }
    a &lt;- Y %% 19
    b &lt;- Y %% 4
    c &lt;- Y %% 7
    d &lt;- (19 * a + M) %% 30
    e &lt;- (2 * b + 4 * c + 6 * d + N) %% 7
    computus.date &lt;- ifelse(d + e &lt; 10,
                     paste("3-", d + e + 22, sep = ""),
                     paste("4-", d + e - 9, sep = ""))
    if (computus.date == "4-26") computus.date &lt;- "4-19"
    if (computus.date == "4-25" &#038; d == 28 &#038; e == 6 &#038; a > 10) computus.date &lt;- "4-19" # 高斯，I 服了 U！
    computus &lt;- paste(Y, computus.date, sep = "-")
  } else if (method == "Meeus")
# Meeus 算法
  {
    # 公历（天主教）
    if (calendar == "Gregorian")
    {
      a &lt;- Y %% 19
      b &lt;- Y %/% 100
      c &lt;- Y %% 100
      d &lt;- b %/%4
      e &lt;- b %%4
      f &lt;- (b + 8) %/% 25
      g &lt;- (b - f + 1) %/%3
      h &lt;- (19 * a + b - d - g + 15) %% 30
      i &lt;- c %/% 4
      k &lt;- c %% 4
      L &lt;- (32 + 2 * e + 2 * i - h - k) %% 7
      m &lt;- (a + 11 * h + 22 * L) %/% 451
      month &lt;- (h + L - 7 * m + 114) %/% 31
      day &lt;- ((h + L - 7 * m + 114) %% 31) + 1
    } else if (calendar == "Julian")
      # 儒略历（东正教）
    {
      a &lt;- Y %% 4
      b &lt;- Y %% 7
      c &lt;- Y %% 19
      d &lt;- (19 * c + 15) %% 30
      e &lt;- (2 * a + 4 * b - d + 34) %% 7
      month &lt;- (d + e + 114) %/% 31
      day &lt;- ((d + e + 114) %% 31) + 1
    } else
    {
      print("sorry, the calendar does not exist. use method = 'Gregorian' or 'Julian'")
    }
    computus &lt;- paste(Y, month, day, sep = "-")
  } else
  {
    print("sorry, the method does not exist. use method = 'Gauss' or 'Meeus'")
  }
  return(computus)
}
</pre>

<p>这个自定义函数使用的时候 method 可以选择 Gauss 或 Meeus 算法，日历可以选择 Gregorian 公历或者 Julian 儒略历。</p>

<p>让我们试试这个自定义函数的运算结果：</p>

<pre><code class="r">computus()
</code></pre>

<pre><code>## [1] &quot;2013-3-31&quot;
</code></pre>

<pre><code class="r">computus(year = 2013, method = "Gauss")
</code></pre>

<pre><code>## [1] &quot;2013-3-31&quot;
</code></pre>

<pre><code class="r">computus(year = 1961)
</code></pre>

<pre><code>## [1] &quot;1961-4-2&quot;
</code></pre>

<pre><code class="r">computus(year = 2000)
</code></pre>

<pre><code>## [1] &quot;2000-4-23&quot;
</code></pre>

<p>都是正确的。</p>

<p>下面让我们计算出本世纪所有年份的天主教复活节：</p>

<pre><code class="r">computus(year = 2000:2099)
</code></pre>

<pre><code>##   [1] &quot;2000-4-23&quot; &quot;2001-4-15&quot; &quot;2002-3-31&quot; &quot;2003-4-20&quot; &quot;2004-4-11&quot;
##   [6] &quot;2005-3-27&quot; &quot;2006-4-16&quot; &quot;2007-4-8&quot;  &quot;2008-3-23&quot; &quot;2009-4-12&quot;
##  [11] &quot;2010-4-4&quot;  &quot;2011-4-24&quot; &quot;2012-4-8&quot;  &quot;2013-3-31&quot; &quot;2014-4-20&quot;
##  [16] &quot;2015-4-5&quot;  &quot;2016-3-27&quot; &quot;2017-4-16&quot; &quot;2018-4-1&quot;  &quot;2019-4-21&quot;
##  [21] &quot;2020-4-12&quot; &quot;2021-4-4&quot;  &quot;2022-4-17&quot; &quot;2023-4-9&quot;  &quot;2024-3-31&quot;
##  [26] &quot;2025-4-20&quot; &quot;2026-4-5&quot;  &quot;2027-3-28&quot; &quot;2028-4-16&quot; &quot;2029-4-1&quot; 
##  [31] &quot;2030-4-21&quot; &quot;2031-4-13&quot; &quot;2032-3-28&quot; &quot;2033-4-17&quot; &quot;2034-4-9&quot; 
##  [36] &quot;2035-3-25&quot; &quot;2036-4-13&quot; &quot;2037-4-5&quot;  &quot;2038-4-25&quot; &quot;2039-4-10&quot;
##  [41] &quot;2040-4-1&quot;  &quot;2041-4-21&quot; &quot;2042-4-6&quot;  &quot;2043-3-29&quot; &quot;2044-4-17&quot;
##  [46] &quot;2045-4-9&quot;  &quot;2046-3-25&quot; &quot;2047-4-14&quot; &quot;2048-4-5&quot;  &quot;2049-4-18&quot;
##  [51] &quot;2050-4-10&quot; &quot;2051-4-2&quot;  &quot;2052-4-21&quot; &quot;2053-4-6&quot;  &quot;2054-3-29&quot;
##  [56] &quot;2055-4-18&quot; &quot;2056-4-2&quot;  &quot;2057-4-22&quot; &quot;2058-4-14&quot; &quot;2059-3-30&quot;
##  [61] &quot;2060-4-18&quot; &quot;2061-4-10&quot; &quot;2062-3-26&quot; &quot;2063-4-15&quot; &quot;2064-4-6&quot; 
##  [66] &quot;2065-3-29&quot; &quot;2066-4-11&quot; &quot;2067-4-3&quot;  &quot;2068-4-22&quot; &quot;2069-4-14&quot;
##  [71] &quot;2070-3-30&quot; &quot;2071-4-19&quot; &quot;2072-4-10&quot; &quot;2073-3-26&quot; &quot;2074-4-15&quot;
##  [76] &quot;2075-4-7&quot;  &quot;2076-4-19&quot; &quot;2077-4-11&quot; &quot;2078-4-3&quot;  &quot;2079-4-23&quot;
##  [81] &quot;2080-4-7&quot;  &quot;2081-3-30&quot; &quot;2082-4-19&quot; &quot;2083-4-4&quot;  &quot;2084-3-26&quot;
##  [86] &quot;2085-4-15&quot; &quot;2086-3-31&quot; &quot;2087-4-20&quot; &quot;2088-4-11&quot; &quot;2089-4-3&quot; 
##  [91] &quot;2090-4-16&quot; &quot;2091-4-8&quot;  &quot;2092-3-30&quot; &quot;2093-4-12&quot; &quot;2094-4-4&quot; 
##  [96] &quot;2095-4-24&quot; &quot;2096-4-15&quot; &quot;2097-3-31&quot; &quot;2098-4-20&quot; &quot;2099-4-12&quot;
</code></pre>

<p>当我敲完上面几十行代码后，突然有些异样的感觉。上网搜了一下，悲催了，原来上面那些自定义函数其实都白敲了，复活节计算从头到尾只需要两行代码：</p>

<pre><code>require(&quot;timeDate&quot;)
Easter()
</code></pre>

<p>每到这个时候，我都会深入理解一次，<strong>R</strong> 的精髓在于包啊！</p>

<p>注：本文是受网友 <a href="http://yangliufr.com/archives/224" target="_blank">yangliufr</a> 的启发写成的。征得 yangliufr 同学的同意后，本打算在 yangliufr 同学所写的代码基础上修改，后来发现 yangliufr 使用的百度百科的计算方法出处不详，所以重新写了代码。在此对 yangliufr 致谢。</p>

<p>注：计算方法参考<a href="http://zh.wikipedia.org/zh-cn/%E5%BE%A9%E6%B4%BB%E7%AF%80%E8%A8%88%E7%AE%97%E8%A1%A8%E5%86%8A" target="_blank">维基百科</a>。</p>

<p><a href="http://dapengde.com/archives/14974" target="_blank">原文链接</a></p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="http://www.pzhao.org/archives/14947/"><span
      aria-hidden="true">&larr;</span> 深情相拥（吉他谱）</a></li>
    

    
    <li class="next"><a href="http://www.pzhao.org/archives/14990/">那些被墙的博客们 <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "pzhao" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Peng Zhao &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-99744900-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>


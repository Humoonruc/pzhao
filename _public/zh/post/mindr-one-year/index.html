<!DOCTYPE html>
<html lang="zh-cn">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.41" />
  <meta name="author" content="Peng Zhao">
  <meta name="description" content="Post-doc in Geoecology">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="http://www.pzhao.org/index.xml" type="application/rss+xml" title="Peng Zhao">
  <link rel="feed" href="http://www.pzhao.org/index.xml" type="application/rss+xml" title="Peng Zhao">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="http://www.pzhao.org/zh/post/mindr-one-year/">

  

  <title>外行 R 包开发手记：mindr | Peng Zhao</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">切换导航</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/zh/">Peng Zhao</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/zh/#about">
            
            <span>关于</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/tags/news">
            
            <span>新闻</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/tags/post">
            
            <span>日志</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/publication">
            
            <span>论文</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/talk">
            
            <span>报告</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/#projects">
            
            <span>项目</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/#teaching">
            
            <span>教学</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/zh/#unclassified">
            
            <span>其他</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="https://cse.google.com/cse/publicurl?cx=006346710622437628329:nxozn9fijm0">
            
            <span>搜索</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/en">
            
            <span>EN</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

  <div class="article-container">
    <h1 itemprop="name">外行 R 包开发手记：mindr</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2018-10-20 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Sat, Oct 20, 2018
    </time>
  </span>

  
  
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/zh/tags/post">post</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fwww.pzhao.org%2fzh%2fpost%2fmindr-one-year%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=%e5%a4%96%e8%a1%8c%20R%20%e5%8c%85%e5%bc%80%e5%8f%91%e6%89%8b%e8%ae%b0%ef%bc%9amindr&amp;url=http%3a%2f%2fwww.pzhao.org%2fzh%2fpost%2fmindr-one-year%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fwww.pzhao.org%2fzh%2fpost%2fmindr-one-year%2f&amp;title=%e5%a4%96%e8%a1%8c%20R%20%e5%8c%85%e5%bc%80%e5%8f%91%e6%89%8b%e8%ae%b0%ef%bc%9amindr"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=http%3a%2f%2fwww.pzhao.org%2fzh%2fpost%2fmindr-one-year%2f&amp;title=%e5%a4%96%e8%a1%8c%20R%20%e5%8c%85%e5%bc%80%e5%8f%91%e6%89%8b%e8%ae%b0%ef%bc%9amindr"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=%e5%a4%96%e8%a1%8c%20R%20%e5%8c%85%e5%bc%80%e5%8f%91%e6%89%8b%e8%ae%b0%ef%bc%9amindr&amp;body=http%3a%2f%2fwww.pzhao.org%2fzh%2fpost%2fmindr-one-year%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>在 CRAN 发布的几个包里， 我对 mindr 情有独钟。它像 pinyin 包一样，结构简单清晰。它得到的用户反馈不像 bookdownplus 包那样让我手足无措。相反，在跟用户的互动中，mindr 在成长，越来越酷。开发升级 mindr，是个很愉快的过程。</p>

<p>(1)</p>

<p>mindr 最初的功能只有两个：一是把 markdown 文本里的标题提取出来，转成思维导图；二是反向操作，把思维导图里的节点按级别转换成 markdown。</p>

<p>想不起来当初是什么让我萌生了开发 mindr 的念头。最大的可能，是在写《学 R》的时候，我想给出版社呈现一个漂亮的大纲。</p>

<p><img src="https://discourse-cdn-sjc1.com/business4/uploads/tidyverse/original/2X/9/9753b6328f86c3f09b7c0a5193cb9c5f51fe89ba.jpeg" alt="" /></p>

<p>对，应该就是这样的，要不然还能是什么？记得我打开 Xmind，把书稿里的标题一个一个拷贝粘贴进来。这时老毛病又犯了：这个过程很机械枯燥，为什么不能自动完成呢？</p>

<p>于是搜索了一下现成的 R 语言包，没找到。我曾经怀疑是不是被我漏掉了，直到后来 mindr 的用户给我发信，说 mindr 是他发现的唯一一个做思维导图的包。这印证了我当时没找到确实是因为不存在。</p>

<p>既然不存在，那么能不能自己动手写一个？目标是思维导图，它的文件结构是什么样的？</p>

<p>我电脑里总共就装了两个思维导图软件，一个是 XMind，另一个就是 FreeMind。</p>

<p>XMind 生成的思维导图文件，用文本编辑器打开后，是一团乱麻。</p>

<p>而 FreeMind 的文件，打开后是逻辑清晰的可读代码。</p>

<p>更关键的是，XMind 可以导入 FreeMind 的文件。不仅 XMind，各大思维导图软件都支持 FreeMind。</p>

<p>这就好办了。几条正则表达式查找替换，核心代码只有几十行，mindr 就这样轻松诞生了。</p>

<p>(2)</p>

<p>刚一诞生，就出了件<a href="http://www.pzhao.org/archives/19414/" target="_blank">怪事</a>：mindr 突然得到了很多星星 (star)。</p>

<p>原来，在一个名叫<a href="https://news.ycombinator.com/item?id=14682567" target="_blank">黑客新闻</a>的地方，它被人围观，评头论足。</p>

<p>我不知道这是个什么论坛，但是我猜，围观的这些人可能都是专业程序员。所以我的感觉就像是一个小孩第一天上幼儿园。</p>

<p>有人上来就说，mindr 没用。思维导图应该用手拿笔画才有用。然后就有人说，现在很多人都用电脑软件画，谁还手绘呀……</p>

<p>有人说，有很多现成的库可以用，pandoc 加个什么 filter 就能转换了，为啥又用 R 写了一个？然后有人说，可能作者只会 R 吧……</p>

<p>更有人说，mindr 带给他的最大收获，是获悉了 bookdown 这个神器……</p>

<p>有意思。非常有意思。</p>

<p><img src="https://discourse-cdn-sjc1.com/business4/uploads/tidyverse/original/2X/3/3b51829766beb6bb64aef4d4ca0e792572a06efd.png" alt="" /></p>

<p>(3)</p>

<p>mindr 基本没遇见太大的 bug。因为它太简单了，而且用户很少，下载量不过几千。</p>

<p>要说最大的 bug，就是<a href="https://community.rstudio.com/t/bookdown-contest-submission-mindr-convert-a-bookdown-project-into-a-mind-map-and-vice-versa/15121/2?u=dapeng" target="_blank">益辉提出</a>的，mindr 错把某处代码里以 “#” 开头的注释当成了章节标题。</p>

<p>这个我有点意外，因为mindr 从一开始就考虑到将三个反引号开头、三个反引号结束的代码块排除在外了，并且拿我自己的书试验过，都把代码块正确干掉了。莫非是我正则表达式用错了？</p>

<p>仔细一查，原来是 mindr 出错的这本书比较特殊，是有关编程的教程，里面出现了四个反引号开始和结束的代码块，里面还嵌着代码块，像个俄罗斯套娃，把没见过世面的 mindr 吓傻了。</p>

<p>等镇定下来，升级之后，这个问题基本解决。之所以说“基本”，是因为 mindr 仍然处理不了三个反引号开头，四个反引号结尾的代码块。mindr 认为他们没有成双成对。这种情况，不仅 mindr 处理不了，typora 也处理不了，sublime 的markdown 插件也处理不了。然而 pandoc 似乎完美处理了。</p>

<p>没啥好说的，业余就是业余。</p>

<p><img src="https://discourse-cdn-sjc1.com/business4/uploads/tidyverse/original/2X/9/9165086d21772e9ae06d405cef10e26e709e0fc2.png" alt="" /></p>

<p>(4)</p>

<p>用户给 mindr 提了很多建议。</p>

<p><a href="https://github.com/pzhaonet/mindr/issues/7" target="_blank">有人说</a>，能不能把 tibble 数据表转换成思维导图。我都不知道什么是 tibble 数据表，也不知道这样做的意义，本想敷衍了事，那人却详细地提出了他的需求，并给了贴心的示例，弄得我不好意思泼冷水。于是花了点工夫，可以从一个近似的数据生成他想要的图。</p>

<p><img src="https://user-images.githubusercontent.com/4011804/36383199-b87064c4-158b-11e8-9ca4-cbbd8c1abddb.jpg" alt="" /></p>

<p><a href="https://github.com/pzhaonet/mindr/issues/11" target="_blank">有人说</a>，能不能别借助第三方软件，而是直接在 R 的界面来展示 markdown 和 FreeMind 的思维导图？这个对我来说超纲了，但是搜了一下，有人开源了一个叫 markup 的包，我修改了一番，就拿来用了。</p>

<p><img src="https://discourse-cdn-sjc1.com/business4/uploads/tidyverse/original/2X/9/9bb0d68237d8f7a71979cd1318a401c4ff31eff8.jpeg" alt="" /></p>

<p><a href="https://github.com/pzhaonet/mindr/issues/9" target="_blank">还有人说</a>，能不能在 markdown 和 FreeMind 相互转换时，保留标题里的超级链接？还有人说，能不能用思维导图来展示电脑里文件夹和子文件夹的结构？<a href="https://github.com/pzhaonet/mindr/issues/12" target="_blank">还有人</a>说，能不能添加一个过滤器，来指定把某个扩展名的文件参加转换？这些功能，虽然我觉得用到的人少之又少，但一听我就知道该如何下手，就当练手，一个一个都实现了。</p>

<p>现在只剩下<a href="https://github.com/pzhaonet/mindr/issues/5" target="_blank">最后一个问题</a>了：能不能将 markdown 里的 LaTeX 公式在转换得到的思维导图里保留下来？</p>

<p>有这种想法的人真疯狂，不过我喜欢。</p>

<p>因为我已经找到了一个很绝妙的解决方案，简单到令人发指。</p>

<p>可惜这里写不下。</p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="http://www.pzhao.org/zh/post/pinyin-one-year/"><span
      aria-hidden="true">&larr;</span> 外行 R 包开发手记：pinyin</a></li>
    

    
    <li class="next"><a href="http://www.pzhao.org/zh/post/how-to-call-for-help/">如何在 R 语言相关论坛求助 <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "pzhao" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Peng Zhao &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-99744900-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>


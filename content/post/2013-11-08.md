---
title: 为博客添加读者墙
author: 大鹏
summary: "<!--:zh-->"
type: post
date: 2013-11-08T15:49:33+00:00
url: /archives/15764
views:
  - 28
categories:
  - 未分类
tags:
  - wordpress

---
<!--:zh-->

[上回书][1]说到，我在给 wordpress 博客添加读者墙的时候，遇到了评论者信息的批量修改问题，于是介绍了一下[批量修改博客评论的方法][1]。很快得到了朋友们的回复，我惊呆了：朋友们哪，那篇的主题不是读者墙啊，这让“批量改评论”这个题目情何以堪。风光无限的前台总是吸引眼球，默默无闻的幕后只能寂寞垂泪。

本篇才是说读者墙的事儿。听从大家的意见，为了整洁和网速，我把墙放到了单独的一个[读者友链][2]页面上。同样是为了整洁和网速，我顺手把评论也挪到了个叫做[评论汇总][3]的单独页面上，侧边栏只保留了个搜索栏和广告栏。这下清净了。

<!--:-->

<!--more-->

<!--:zh-->

### 安装

给 wordpress 博客添加读者墙，容易。在 wordpress 后台插件安装界面搜索 [readers wall][4]，安装就行了。在帖子哪里输入方括号括起来的 readerswall，哪里就会出现读者墙。动画效果可以去插件的设置界面修改。就这么简单。

麻烦的是后边。

### 重复头像问题

安心博客的博主提意见，说墙上出现了两个他的头像。勺子也有两个（他自己博客的墙上也有两个）。两个还算是少的，碧云飘鹤的博主，我的老乡马光出现了三次。我在数据库里查了一下，终于闹明白了。原来，虽然 id 留的都是马光，但邮箱有时是 m&#8230;qq.com，有时是 ma&#8230;.net，有时是mag&#8230;net，readers wall 根据邮箱来区分，把他们当做了三个马光。这好办，用[上回书][1]讲的方法，批量修改评论者的邮箱即可：

    UPDATE wp_comments SET comment_author_email = 'ma....net' WHERE comment_author = '马光' ;
    

这不能怪马光，都怪我用了多说插件。同一个人，有时候登录了 qq，在我博客上留言时就自动留下了他的 qq 邮箱，于是跟以前的信息不一致了。我发现，这个读者墙插件是以邮箱为唯一标识的，只要邮箱相同，就认为是同一个评论者，不管 id 是否相同。所以，土木坛子曾在评论时用过“土木坛子”、“日光之下并无新事”、“土木坛子还活着”、“依然可访问”等多个id，但邮箱从没变过，因此就被认为是同一个评论者，列在读者墙上了。

为了避免日后的混乱，我停用了多说插件，还是请评论者留信箱比较清爽。

### 去掉博主头像问题

莫失莫忘的博主 yxiao 反问我为何把我自己也列在读者墙上。是的，这样的确不妥。我找到了办法把自己从中去掉了。readers wall 插件只列出数据库中 user\_id 值为 0 的评论者，所以我把自己的 user\_id 改为 1，就从读者墙上消失了。方法是

    UPDATE wp_comments SET user_id =1 WHERE comment_author =  'dapeng' ;
    

### 空邮箱问题

[上回书][1]提到，我的读者墙排在第一是 mono Miao，这是我的师姐。墙上显示她发了 354 条评论，而我在后台遍寻不着。原因被我找到了，因为她发表的部分评论没有留她的邮箱。由于邮箱是区分读者的唯一标识，readers wall 就把这些评论和其他众多没有留邮箱的评论都归到她的名下，排在了前头。

这个假信息，必须要去掉。正如去掉博主头像的方法，只要给那些没留邮箱的评论修改一下 user_id就行了。我把他们改成了 24。至于为什么，你猜。

    UPDATE wp_comments SET user_id =24 WHERE comment_author_email =  '' ;
    

<!--:-->

 [1]: http://pzhao.org/2013-11-07-%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E5%8D%9A%E5%AE%A2%E8%AF%84%E8%AE%BA/
 [2]: http://pzhao.org/friends/
 [3]: http://pzhao.org/comments/
 [4]: http://blog.leniy.org/readers-wall.html
